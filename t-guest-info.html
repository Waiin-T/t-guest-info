<!--<link rel="import" href="bower_components/polymer/polymer.html">
<link rel="import" href="bower_components/polymer/polymer-element.html">
<link rel="import" href="bower_components/app-layout/app-toolbar/app-toolbar.html">
<link rel="import" href="bower_components/iron-icons/iron-icons.html">
<link rel="import" href="bower_components/paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="bower_components/paper-listbox/paper-listbox.html">
<link rel="import" href="bower_components/paper-item/paper-item.html">
<link rel="import" href="bower_components/paper-input/paper-input.html">
<link rel="import" href="bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="bower_components/paper-button/paper-button.html">
<link rel="import" href="bower_components/iron-media-query/iron-media-query.html">-->

<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../polymer/polymer-element.html">
<link rel="import" href="../app-layout/app-toolbar/app-toolbar.html">
<link rel="import" href="../iron-icons/iron-icons.html">
<link rel="import" href="../paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="../paper-listbox/paper-listbox.html">
<link rel="import" href="../paper-item/paper-item.html">
<link rel="import" href="../paper-input/paper-input.html">
<link rel="import" href="../paper-icon-button/paper-icon-button.html">
<link rel="import" href="../paper-button/paper-button.html">
<link rel="import" href="../iron-media-query/iron-media-query.html">
<link rel="import" href="t-traveler-info.html">
<link rel="import" href="t-loyalty-program.html">

<dom-module id="t-guest-info">
  <template>
    <style>
       :host {
        display: block;
        background-color: white;
      }

      #travelerInfo {
        margin-top: 40px;
      }

      #toolbar1 {
        background-color: transparent;
        border: 1px solid lightgray;
        margin: 10px;
        color: #478BD7;
        height: 60px;
      }

      #signInLink {
        color: #478BD7;
        text-decoration: none;
        font-size: 16px;
      }

      /*.item[LargeDesktopview]*/
      #chooseGuest {
        width: 40%;
        position: relative;
        float: left;
        margin-top: 335px;
        margin-bottom: 100px;
        /*margin-left: -542px;*/
      }

      /*.item[smallMobileView]#chooseGuest {
        width: 50%;
        background-color: violet;
        float: left;
      }

      .item[mobileView] #chooseGuest {
        width: 15%;
        position: relative;
        float: left;
      }

      .item[tablet] #chooseGuest {
        width: 15%;
        position: relative;
        float: left;
      }*/

      #loyaltyDiv {
        width: 67%;
      }

      #toolbarLotalty {
        background-color: #E8E8E8;
        width: 100%;
        margin-left: 10px;
        margin-top: 20px;
        height: 50px;
      }

      #tLoyaltyDatabase {
        margin-top: 2%;
      }

      #addProgramForOtherGuestButton {
        color: var(--color-for-button-labels);
        margin-left: 50px;
        float: left;
        margin-top: 3%;
      }
    </style>
    <iron-media-query query="(max-width: 380px)" query-matches="{{smallMobileView}}"></iron-media-query>
    <iron-media-query query="(min-width: 380px) and (max-width:767px)" query-matches="{{mobileView}}"></iron-media-query>
    <iron-media-query query="(min-width: 768px) and (max-width:1023px)" query-matches="{{tabletView}}"></iron-media-query>
    <iron-media-query query="(min-width: 1024px) and (max-width: 1200px)" query-matches="{{desktopView}}"></iron-media-query>
    <iron-media-query query="(min-width: 1200px)" query-matches="{{largeDesktopView}}"></iron-media-query>
    <iron-media-query query="(max-width: 600px)" query-matches="{{mediumTablet}}"></iron-media-query>
    <iron-media-query query="(max-width: 767px)" query-matches="{{mobilePhone}}"></iron-media-query>
    <div class="item" smallMobileView$="{{smallMobileView}}" desktopView$="{{desktopView}}" tabletView$="{{tabletView}}" mobileView$="{{mobileView}}">

      <app-toolbar id="toolbar1"><a href="#" id="signInLink">Sign in to make booking faster</a></app-toolbar>

      <template is="dom-repeat" items="{{product}}">
        <template is="dom-repeat" items="{{item.rooms}}">
          <t-traveler-info id="travelerInfo{{_increaseIndex(index)}}" title="{{title}} {{_increaseIndex(index)}}" sub-title="{{item.name}} | {{item.criteria.traveler.adult}} Adults, {{item.criteria.traveler.child}} Child"
            policy-List="{{item.policies}}" pax-list="{{paxlist}}" option="[[option]]" resource="{{resources}}" adult-pax-count="{{item.criteria.traveler.adult}}"
            child-pax-count="{{item.criteria.traveler.child}}" only-lead-pax-info="{{item.onlyLeadPaxInfo}}">
          </t-traveler-info>
          <div hidden$={{_doNotShowForRoom1(index,1)}}>
            <paper-dropdown-menu label="Choose guest" id="chooseGuest" required auto-validate error-message="chooseguest please">
              <paper-listbox slot="dropdown-content" selected="{{selectedGuest}}">
                <template is="dom-repeat" items={{paxlist}}>                
                <paper-item>{{item.firstName}}</paper-item>
                <paper-item>hello</paper-item>
                </template>
              </paper-listbox>
            </paper-dropdown-menu>
          </div>
          <br>
        </template>
      </template>
    </div>

    <div id="loyaltyDiv">
      <div>
        <app-toolbar id="toolbarLotalty">Loyalty program</app-toolbar>
        <template is="dom-reapeat" items={{loyaltyPrograms}}>
        <t-loyalty-program id="tLoyaltyDatabase">{{item}}</t-loyalty-program>
        </template>
      </div>
      <div>
        <paper-button id=addProgramForOtherGuestButton on-tap="_addProgramForOtherGuest">Add program for other guest</paper-button>
      </div>
    </div>
    <br>
    <br>

  </template>

  <script>
    /**
     * `t-guest-info`
     * 
     *
     * @customElement
     * @polymer
     * @demo demo/index.html
     */
    class TGuestInfo extends Polymer.Element {

      static get is() {
        return 't-guest-info';
      }
      static get properties() {
        return {
          loyaltyPrograms: {
            type: Array,
          },
          onlyLeadPaxInfo: {
            type: Boolean,
            value: true
          },
          smallMobileView: {
            type: Boolean,
            value: false
          },
          mobileView: {
            type: Boolean,
            value: false
          },
          tabletView: {
            type: Boolean,
            value: false
          },
          desktopView: {
            type: Boolean,
            value: false
          },
          largeDesktopView: {
            type: Boolean,
            value: false
          },
          title: {
            type: String,
            value: 'Room'
          },
          subTitle: {
            type: String,
          },
          adultPaxCount: {
            type: Number
          },
          childPaxCount: {
            type: Number
          },
          paxlist: {
            type: Array,
            value: []
          },
          policyList: {
            type: Array
          },

          option: {
            type: Object,
            value: {
              "requiredField": [],
              "requiredFieldForLeadPax": []
            }
          },
          resources: {
            type: Object
          },
          paxList1: {
            type: Object,
            value: {
              "membership": {}
            }
          },
          product: {
            type: Object,
            value: {
              "rooms": []
            }
          },
          allowTitle: {
            type: Boolean,
            value: false
          },
          allowTitleForLeadPax: {
            type: Boolean,
            value: false
          },
          allowContactNumber: {
            type: Boolean,
            value: false
          },
          allowContactNumberForLeadPax: {
            type: Boolean,
            value: false
          },
          allowEmail: {
            type: Boolean,
            value: false
          },
          allowEmailForLeadPax: {
            type: Boolean,
            value: false
          },
          requiredField: {
            type: Array,
            value: [
              "firstname",
              "lastname"
            ]
          },
          requiredFieldForLeadPax: {
            type: Array,
            value: [
              "contactNumber",
              "title",
              "email"
            ]
          },
          terms: {
            type: String,
            value: 'terms-ico'
          },
          adultTitle: {
            type: String,
            value: 'Adult {count}'
          },
          adultInfo: {
            type: String,
            value: '(12+ years)'
          },
          childTitle: {
            type: String,
            value: 'Child {count}'
          },
          childInfo: {
            type: String,
            value: '(upto 7 years)'
          },
          titleValues: {
            type: Array,
            value: [{
                "key": "Mr"
              },
              {
                "key": "Ms"
              }
            ]
          },
          titleSelected: {
            type: String,
            value: 'Mr'
          },
          titleLabel: {
            type: String,
            value: 'Title'
          },
          titleError: {
            type: String,
            value: 'Please select a title'
          },
          firstNameValue: {
            type: String,
            value: ''
          },
          firstnameTitle: {
            type: String,
            value: 'First name'
          },
          firstNameError: {
            type: String,
            value: 'Firstname is required'
          },
          lastNameValue: {
            type: String,
            value: ''
          },
          lastnameTitle: {
            type: String,
            value: 'Last name'
          },
          lastNameError: {
            type: String,
            value: 'Lastname is required'
          },
          emailValue: {
            type: String,
            value: ''
          },
          emailTitle: {
            type: String,
            value: 'Email address'
          },
          emailInfo: {
            type: String,
            value: 'We will send you email confirmation on this address'
          },
          emailError: {
            type: String,
            value: 'Please enter a valid email address'
          },
          countryCodeValues: {
            type: Array,
            value: [{
                "key": "India +91",
                "value": "91"
              },
              {
                "key": "USA +1",
                "value": "1"
              }
            ]
          },
          countryCodeTitle: {
            type: String,
            value: 'Country code'
          },
          countryCodeError: {
            type: String,
            value: 'Countrycode is required'
          },
          contactNumberValue: {
            type: Number,
            value: ''
          },
          contactNumberTitle: {
            type: String,
            value: 'Contact number'
          },
          contactNumberInfo: {
            type: String,
            value: 'In case of any notifications our agent will reach you on this number'
          },
          contactNumberError: {
            type: String,
            value: 'Contact number is required'
          },          
          productID: {
            type: String,
            value: '123123'
          },
          productName: {
            type: String,
            value: 'El Cortez Hotel &; Casino'
          },
          productAllowLoyalty: {
            type: Boolean,
            value: true,
          },
        };
      } //End of Properties.

      _defaultOptionValue() {
        if (this.option === undefined) {
          this.allowContactNumber;
          this.allowContactNumberForLeadPax;
          this.allowTitle;
          this.allowTitleForLeadPax;
          this.allowEmail;
          this.allowEmailForLeadPax;
          this.requiredField;
          this.requiredFieldForLeadPax;
        } else {
          if (this.option.allowTitleForLeadPax){
            this.allowTitleForLeadPax = this.option.allowTitleForLeadPax;
          }
          if (this.option.allowTitle){
            this.allowTitle = this.option.allowTitle;
          }
          if (this.option.allowContactNumber){
            this.allowContactNumber = this.option.allowContactNumber;
          }
          if (this.option.allowContactNumberForLeadPax){
            this.allowContactNumberForLeadPax = this.option.allowContactNumberForLeadPax;
          }
          if (this.option.allowEmail){
            this.allowEmailt = this.option.allowEmail;
          }
          if (this.option.allowEmailForLeadPax){
            this.allowEmailForLeadPax = this.option.allowEmailForLeadPax;
          }
          if (this.option.requiredField ){
            this.requiredField = this.option.requiredField;
          }
          if (this.option.requiredFieldForLeadPax){
            this.requiredFieldForLeadPax = this.option.requiredFieldForLeadPax;
          }
        }
      }
      _defaultResourcesValue() {
        if (this.resources.icons.terms){
          this.terms = this.resources.icons.terms;
        }
        if (this.resources.labels.adult === undefined) {
          this.adultTitle;
          this.adultInfo;
        } else {
          if (this.resources.labels.adult.title){
            this.adultTitle = this.resources.labels.adult.title;
          }
          if (this.resources.labels.adult.info){
            this.adultInfo = this.resources.labels.adult.info;
          }
        }
        if (this.resources.labels.child === undefined) {
          this.childTitle;
          this.childInfo;
        } else {
          if (this.resources.labels.child.title){
            this.childTitle = this.resources.labels.child.title;
          }
          if (this.resources.labels.child.info){
            this.childInfo = this.resources.labels.child.info;
          }
        }
        if (this.resources.fields.title === undefined) {
          this.titleValues;
          this.titleSelected;
          this.titleLabel;
          this.titleError;
        } else {
          if (this.resources.fields.title.values){
            this.titleValues = this.resources.fields.title.values;
          }
          if (this.resources.fields.title.selected){
            this.titleSelected = this.resources.fields.title.selected;
          }
          if (this.resources.fields.title.title){
            this.titleLabel = this.resources.fields.title.title;
          }
          if (this.resources.fields.title.errors){
            this.titleError = this.resources.fields.title.errors;
          }
        }
        if (this.resources.fields.firstName === undefined) {
          this.firstNameValue;
          this.firstnameTitle;
          this.firstNameError;
        } else {
          if (this.resources.fields.firstName.value){
            this.firstNameValue = this.resources.fields.firstName.value;
          }
          if (this.resources.fields.firstName.title){
            this.firstnameTitle = this.resources.fields.firstName.title;
          }
          if (this.resources.fields.firstName.errors){
            this.firstNameError = this.resources.fields.firstName.errors;
          }
        }
        if (this.resources.fields.lastName === undefined) {
          this.lastNameValue;
          this.lastnameTitle;
          this.lastNameError;
        } else {
          if (this.resources.fields.lastName.value ){
            this.lastNameValue = this.resources.fields.lastName.value;
          }
          if (this.resources.fields.lastName.title){
            this.lastnameTitle = this.resources.fields.lastName.title;
          }
          if (this.resources.fields.lastName.errors){
            this.lastNameError = this.resources.fields.lastName.errors;
          }
        }
        if (this.resources.fields.email === undefined) {
          this.emailValue;
          this.emailTitle;
          this.emailInfo;
          this.emailError;
        } else {
          if (this.resources.fields.email.value){
            this.emailValue = this.resources.fields.email.value;
          }
          if (this.resources.fields.email.title){
            this.emailTitle = this.resources.fields.email.title;
          }
          if (this.resources.fields.email.errors){
            this.emailInfo = this.resources.fields.email.errors;
          }
          if (this.resources.fields.email.errors){
            this.emailError = this.resources.fields.email.errors;
          }
        }
        if (this.resources.fields.countryCode === undefined) {
          this.countryCodeValues;
          this.countryCodeTitle;
          this.countryCodeError;
        } else {
          if (this.resources.fields.countryCode.values){
            this.countryCodeValues = this.resources.fields.countryCode.values;
          }
          if (this.resources.fields.countryCode.title){
            this.countryCodeTitle = this.resources.fields.countryCode.title;
          }
          if (this.resources.fields.countryCode.errors){
            this.countryCodeError = this.resources.fields.countryCode.errors;
          }
        }
        if (this.resources.fields.contactNumber === undefined) {
          this.contactNumberValue;
          this.contactNumberTitle;
          this.contactNumberInfo;
          this.contactNumberError;
        } else {
          if (this.resources.fields.contactNumber.value ){
            this.contactNumberValue = this.resources.fields.contactNumber.value;
          }
          if (this.resources.fields.contactNumber.title){
            this.contactNumberTitle = this.resources.fields.contactNumber.title;
          }
          if (this.resources.fields.contactNumber.errors){
            this.contactNumberInfo = this.resources.fields.contactNumber.errors;
          }
          if (this.resources.fields.contactNumber.errors){
            this.contactNumberError = this.resources.fields.contactNumber.errors;
          }
        }
      }
     
      _increaseIndex(index) {
        var calIndex = index + 1;
        return calIndex;
      }
      isValidGuest() {
        var validData = [];
        var productLength = this.product.length;
        for (var i = 0; i < productLength; i++) {
          var roomsLength = this.product[i].rooms.length;
          for (var j = 0; j < roomsLength; j++) {
            validData[j] = Polymer.dom(this.root).querySelector("#travelerInfo" + (j + 1)).isValid();
          }
          for (var j = 0; j < roomsLength; j++) {
            if (validData[j] === false) {
              return false;
            } else {
              return true;
            }
          }
        }
      }
      isData() {
        var totalData = [];
        var data = [];
        var prodLen = this.product.length;
        for (var i = 0; i < prodLen; i++) {
          var roomLen = this.product[i].rooms.length;
          for (var j = 0; j < roomLen; j++) {
            data[j] = Polymer.dom(this.root).querySelector("#travelerInfo" + (j + 1)).getState(event);
          }
          totalData[i] = data;
        }
        var totalDataObjectArray = JSON.stringify(totalData);
        console.log(totalDataObjectArray);
        var totalDataObject = JSON.parse(totalDataObjectArray);
        console.log(totalDataObject);
        return totalDataObject;
      }
      _doNotShowForRoom1(room1, roomNumber) {
        return room1 < roomNumber;
      }
      _addProgramForOtherGuest(){
        this.push('loyaltyPrograms', { loyaltyProgram: "" });
      }
      ready() {
        super.ready();
        this.loyaltyPrograms = [];
        this._defaultOptionValue();
        this._defaultResourcesValue();
          this.push('loyaltyPrograms', { loyaltyProgram: "" });
      }
    }

    window.customElements.define(TGuestInfo.is, TGuestInfo);
  </script>
</dom-module>