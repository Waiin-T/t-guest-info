<link rel="import" href="pax-info.html">
<link rel="import" href="pax-info-child.html">

<dom-module id="t-traveler-info">
    <template>
        <style>
           
            #toolbarRoom {
                background-color: #E8E8E8;
                width: 100%;
                margin-left: 10px;
                margin-top: 20px;
                height: 50px;
            }

            #productPassengers {
                width: 67%;
            }

            #subTitle {
                color: gray;
                font-size: 14px;
                padding: 5px;
            }

            #title {
                font-size: 16px;
                padding: 5px;
            }

            #policyList {
                color: #4CB050;
                margin-top: 20px;
                font-family: roboto;
            }

            #checkIcon {
                margin-left: 10px;
            }
            /*#paxInfo, #closeIcon{
                float: left;
            }*/

            #closeIcon {
                margin-top: 4%;
                margin-left: -10px;
                color: #A8A8A8;
            }

            #paxInfoTemp {
                float: left;
                width: 96%;
            }
        </style>
        <div id="productPassengers">
            <app-toolbar id="toolbarRoom">
                <div id="title">{{title}}</div>
                <div id="titleDash"> - </div>
                <div id="subTitle">{{subTitle}}</div>
            </app-toolbar>

            <div id="policyList">
                <template is="dom-repeat" items={{policyList}}>
                    <br>
                <!--<iron-icon icon="check" id="checkIcon"></iron-icon>-->
                <img id="checkIcon" src="checkImage.svg" height="10" width="10">
                {{item}}
                </template>
            </div>
            <template is="dom-repeat" items="{{adultPaxCountArray}}">
                <div id="paxInfoTemp">
                    <pax-info id="paxInfo" pax-list="{{paxlist}}" id="paxInfoId" option="[[option]]" resource="{{resource}}" index="{{_increaseIndex(index)}}" adult-pax-count="{{adultPaxCount}}"></pax-info>
                    <div hidden$=[[_isCloseButtonHidden]]>
                    <paper-icon-button icon="close" id="closeIcon" on-tap="_closePaxAdultInfo"></paper-icon-button>
                    </div>
                </div>
            </template>
            <template is="dom-repeat" items="{{childPaxCountArray}}">
                <div id="paxInfoTemp">
                    <pax-info-child id="paxInfo" pax-list="{{paxlist}}" id="paxInfoId" option="[[option]]" resource="{{resource}}" index="{{_increaseIndex(index)}}"></pax-info-child>
                    <paper-icon-button icon="close" id="closeIcon" on-tap="_closePaxChildInfo"></paper-icon-button>
                </div>
            </template>

        </div>


    </template>

    <script>
        /**
     * `t-traveler-info`
     * 
     *
     * @customElement
     * @polymer
     * @demo demo/index.html
     */
        class TTravelerInfo extends Polymer.Element {
            static get is() { return 't-traveler-info'; }
            static get properties() {
                return {
                    option: {
                        type: Object,
                        value: {
                            "requiredField": [],
                            "requiredFieldForLeadPax": []
                        }
                    },
                    adultPaxCount: {
                        type: Number,
                    },
                    adultPaxCountArray: {
                        type: Array,
                    },
                    childPaxCount: {
                        type: Number,
                    },
                    childPaxCountArray: {
                        type: Array,
                    },
                    totalPaxCount: {
                        type: Array,

                    },
                    paxList: {
                        type: Object,
                        value: {
                            "membership": {}
                        }
                    },
                    product: {
                        type: Object,
                        value: {
                            "rooms": []
                        }
                    },
                    policyList: {
                        type: Array,
                    },
                    resource: {
                        type: Object
                    },
                    showCloseButton: {
                        type: Boolean,
                        value: false 
                    },
                    _isCloseButtonHidden: {
                    type: Boolean,
                    computed: '_lte(adultPaxCountArray.length , 1)'
                },
                };
            }
             _lte(adultPaxCountArrayLength, hiddenButtonAdultNumber) {
                return adultPaxCountArrayLength <= hiddenButtonAdultNumber;
            }
            _closeIconIfAdultIsOnlyOne(){
                var adultCount = this.adultPaxCount;
                if(adultCount === 1){
                    this.showCloseButton = true;
                }
            }
            _closePaxAdultInfo(e) {
                this.splice('adultPaxCountArray', e.model.index, 1);
            }
            _closePaxChildInfo(e) {
                this.splice('childPaxCountArray', e.model.index, 1);
            }
            _increaseIndex(index) {
                var calIndex = index + 1;
                return calIndex;
            }
            ready() {
                super.ready();
                this._closeIconIfAdultIsOnlyOne();
                var adultPax = this.adultPaxCount;
                var childPax = this.childPaxCount;
                var totalPax = +adultPax + +childPax;
                var adultPaxCount1 = [];
                for (var i = 0; i < adultPax; i++) {
                    adultPaxCount1.push(i);
                }
                this.adultPaxCountArray = adultPaxCount1;
                var childPaxCount1 = [];
                for (var i = 0; i < childPax; i++) {
                    childPaxCount1.push(i);
                }
                this.childPaxCountArray = childPaxCount1;
            }
        }

        window.customElements.define(TTravelerInfo.is, TTravelerInfo);
    </script>
</dom-module>