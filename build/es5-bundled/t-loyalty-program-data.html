<html><head><link rel="import" href="../polymer/polymer-element.html"></head><body><dom-module id="t-loyalty-program-data"><template><style>:host{display:block;}paper-dropdown-menu{--paper-input-container-underline-focus:#4CB050;--paper-input-container-focus-color:#4CB050;--paper-input-container-label-focus:lightgray;}paper-input{--paper-input-container-underline-focus:#4CB050;--paper-input-container-focus-color:#4CB050;--paper-input-container-label-focus:lightgray;}@media (min-width: 320px) and (max-width:380px){.guestName{width:45%;margin-left:-5px;}.programName{width:45%;margin-left:11px;}.programNumber{width:45%;margin-left:-5px;}#buttonRemove{margin-left:10px;margin-top:20px;width:60px;color:var(--color-for-button-labels);font-weight:450;text-transform:capitalize;}}@media (min-width: 380px) and (max-width:767px){.guestName{width:45%;margin-left:-5px;}.programName{width:45%;margin-left:11px;}.programNumber{width:45%;margin-left:-5px;}#buttonRemove{margin-left:15px;margin-top:6%;width:60px;color:var(--color-for-button-labels);font-weight:450;text-transform:capitalize;}}@media (min-width: 768px) and (max-width:1023px){.guestName{width:22%;}.programName{width:22%;margin-left:10px;}.programNumber{width:22%;margin-left:10px;}#buttonRemove{margin-top:5%;margin-left:20px;width:60px;color:var(--color-for-button-labels);font-weight:450;text-transform:capitalize;}}@media (min-width: 1024px){.guestName{width:21%;margin-left:10px;}.programName{width:21%;margin-left:25px;}.programNumber{width:21%;margin-left:25px;}#buttonRemove{margin-top:2%;margin-left:65px;width:60px;color:var(--color-for-button-labels);font-weight:450;text-transform:capitalize;}}.guestName,
      .programName,
      .programNumber,
      #buttonRemove{float:left;}#guestNameError{font-size:var(--paper-font-caption_-_font-size);color:var(--paper-deep-orange-a700);}.item{clear:both;}</style><div class="guestName" id="guestNameDiv"><paper-dropdown-menu label="{{_guestName}}" id="guestName{{loyaltyProgramNumber}}" on-blur="_isValid" on-tap="_updatePaxList" invalid="{{_guestNameInvalid}}"><paper-listbox slot="dropdown-content" selected="{{loyaltyProgramData.guestName}}"><template is="dom-repeat" items="{{_tempPaxArray}}"><paper-item id="{{loyaltyProgramNumber}}" on-tap="_showGuestProgramDetails">{{item.firstName}}&nbsp;{{item.lastName}}</paper-item></template></paper-listbox></paper-dropdown-menu><input is="iron-input" type="hidden" bind-value="[[loyaltyProgramData.guestName]]"><div id="guestNameError" hidden$="{{_showGuestNameError}}">{{_guestNameError}}</div></div><div hidden$="{{_showProgramNameInput}}"><paper-input label="{{_programName}}" id="programNameInput{{loyaltyProgramNumber}}" value="{{loyaltyProgramData.programName}}" invalid="{{_programNameInvalid}}" on-blur="_isValid" class="programName"></paper-input></div><div hidden$="{{_showProgramNameDropdown}}"><paper-dropdown-menu label="{{_programName}}" id="programName{{loyaltyProgramNumber}}" invalid="{{programNameInvalid}}" on-blur="_isValid" class="programName"><paper-listbox slot="dropdown-content" selected="{{loyaltyProgramData.programName}}"><template is="dom-repeat" items="{{paxList}}"><paper-item>{{item.membership.programName}}</paper-item></template></paper-listbox></paper-dropdown-menu><input is="iron-input" type="hidden" bind-value="[[loyaltyProgramData.programName]]"></div><div><paper-input label="{{_programNumber}}" id="programNumber{{loyaltyProgramNumber}}" value="{{loyaltyProgramData.programNumber}}" invalid="{{_programNumberInvalid}}" class="programNumber" on-blur="_isValid"></paper-input></div></template><script>var TLoyaltyProgramData=function(a){function b(){return babelHelpers.classCallCheck(this,b),babelHelpers.possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return babelHelpers.inherits(b,a),babelHelpers.createClass(b,[{key:'ready',value:function(){babelHelpers.get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),'ready',this).call(this),this._showProgramName(),this._setDefaultRsourcesValue()}},{key:'_setDefaultRsourcesValue',value:function(){this._remove=this.resources.loyaltyProgram.remove?this.resources.loyaltyProgram.remove:'Remove',this._guestNameError=this.resources.loyaltyProgram.guestNameError?this.resources.loyaltyProgram.guestNameError:'Please enter guest details first',this._guestName=this.resources.loyaltyProgram.label.guestName?this.resources.loyaltyProgram.label.guestName:'Guest name',this._programName=this.resources.loyaltyProgram.label.programName?this.resources.loyaltyProgram.label.programName:'Program name',this._programNumber=this.resources.loyaltyProgram.label.programNumber?this.resources.loyaltyProgram.label.programNumber:'Program number'}},{key:'_lessThanEqualToOne',value:function(a,b){return a<=b}},{key:'_showProgramName',value:function(){!1===this.paxListAvailable?this._showProgramNameInput=!1:this._showProgramNameDropdown=!1}},{key:'_isValid',value:function(a){a.currentTarget.invalid=!1;var b=this._updatePaxList(),c=this.loyaltyProgramData.guestName,d=this.loyaltyProgramData.programName;this.loyaltyProgramsArray[this.loyaltyProgramNumber].guestName=c,this.loyaltyProgramsArray[this.loyaltyProgramNumber].programName=d,this.loyaltyProgramsArray[this.loyaltyProgramNumber].programNumber=this.loyaltyProgramData.programNumber,this._isValidLoyalty(this.loyaltyProgramNumber,a,c,d,this.loyaltyProgramData.programNumber)}},{key:'_showGuestProgramDetails',value:function(a){if(!0===this.paxListAvailable){var b=a.model.itemsIndex,c=this.paxList,d=this.paxList.findIndex(function(a){return a.membership==c[b].membership});this.loyaltyProgramData.programName=d,this.loyaltyProgramData.programNumber=c[b].membership.number,this.notifyPath('loyaltyProgramData.loyaltyProgram'),this._guestNameInvalid=!1,this._programNameInvalid=!1,this._programNumberInvalid=!1}}},{key:'_updatePaxList',value:function(){if(!1===this.paxListAvailable){for(var a=[],b=this.totalPaxList.length,c=0;c<b;c++)if(this.index-1===c)for(var d,e=this.totalPaxList[c].paxListObj.length,f=0;f<e;f++){d=this.totalPaxList[c].paxListObj[f].paxListObj.length;for(var g=0;g<d;g++){var h=this.totalPaxList[c].paxListObj[f].paxListObj[g],i=this.totalPaxList[c].paxListObj[f].paxListObj[g];void 0===h?''!=i.firstName&&a.push(i):''!=h.firstName&&a.push(h)}}for(var j=a,c=0;c<j.length;c++)for(var f=c+1;f<j.length;f++)j[c].firstName===j[f].firstName&&j[c].lastName===j[f].lastName&&j.splice(f,1);this._tempPaxArray=j}else this._tempPaxArray=this.paxList;if(0===this._tempPaxArray.length){this._showGuestNameError=!1,this._guestNameInvalid=!0;this.loyaltyProgramsArray.length}else this._showGuestNameError=!0,this._guestNameInvalid=!1;return this._tempPaxArray}},{key:'_isValidLoyalty',value:function(a,b,c,d,e){for(var f=this.loyaltyProgramsArray.length,g=0;g<f;g++){var h=this.loyaltyProgramsArray[g].guestName,i=this.loyaltyProgramsArray[g].programName,j=this.loyaltyProgramsArray[g].programNumber;void 0!=h&&c===h&&d===i&&e===j&&a!=g&&(-1!=c||''!=d||''!=e)&&(b.currentTarget.invalid=!0,b.currentTarget.errorMessage='duplicate record')}}}],[{key:'is',get:function(){return't-loyalty-program-data'}},{key:'properties',get:function(){return{index:Number,totalPaxList:Array,loyaltyProgramsArray:{type:Array},loyaltyProgramData:Object,paxList:{type:Object},paxListAvailable:{type:Boolean},loyaltyProgramNumber:Number,_smallMobileView:{type:Boolean,value:!1},_mobileView:{type:Boolean,value:!1},_tabletView:{type:Boolean,value:!1},_desktopView:{type:Boolean,value:!1},_largeDesktopView:{type:Boolean,value:!1},_tempPaxArray:{type:Array,value:[]},_showGuestNameError:{type:Boolean,value:!0},_isRemoveButtonHidden:{type:Boolean,computed:'_lessThanEqualToOne(loyaltyProgramsArray.length , 1)'},_showProgramNameInput:{type:Boolean,value:!0},_showProgramNameDropdown:{type:Boolean,value:!0},_guestNameInvalid:{type:Boolean,value:!1},_programNameInvalid:{type:Boolean,value:!1},_programNumberInvalid:{type:Boolean,value:!1},_remove:String,_guestNameError:String,_guestName:String,_programName:String,_programNumber:String}}}]),b}(Polymer.Element);window.customElements.define(TLoyaltyProgramData.is,TLoyaltyProgramData);</script></dom-module></body></html>