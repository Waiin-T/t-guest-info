<dom-module id="pax-info">
    <template>
        <style>
             :host {
                display: block;
            }

            paper-dropdown-menu {
                --paper-input-container-underline-focus: #4CB050;
                --paper-input-container-focus-color: #4CB050;
                --paper-input-container-label-focus: lightgray;
            }

            paper-input {
                --paper-input-container-underline-focus: #4CB050;
                --paper-input-container-focus-color: #4CB050;
                --paper-input-container-label-focus: lightgray;
            }

            .inputForm #adultPaxTitle,
            #adultFirstName,
            #adultLastName {
                float: left;
            }

            #adultEmailAndLabel,
            #adultCountryCode,
            #adultContactNo {
                float: left;
            }

            #typeAndLabel {
                width: 22%;
                float: left;
                margin-top: 4%;
                margin-left: 10px;
            }

            #typeLabel,
            #typeSubLabel {
                float: left;
            }

            #typeSubLabel {
                margin-left: 5px;
                font-size: smaller;
                color: #BDBDBD;
            }

            #adultPaxTitle {
                width: 21%;
                margin-left: 10px;
            }

            #adultFirstName {
                width: 21%;
                margin-left: 20px;
            }

            #adultLastName {
                width: 21%;
                margin-left: 20px;
            }

            #inputForm2 {
                margin-top: 15px;
            }

            #adultEmail {}

            #adultEmailAndLabel {
                margin-left: 10px;
                width: 44.5%;
            }

            #adultEmailLabel {
                font-size: smaller;
                color: #BDBDBD;
            }

            #adultCountryCode {
                width: 21%;
                margin-left: 20px;
            }

            #adultContactNo {
                width: 21%;
                margin-left: 20px;
            }
        </style>

        <form is="iron-form" id="form" method="post" action="/form/handler">
            <div class="inputForm">
                <div id="typeAndLabel" hidden$="{{showTypeLabel}}">
                    <label id="typeLabel">{{resource.labels.adult.title}} {{index}}</label>
                    <div id="typeSubLabel"> {{resource.labels.adult.info}}</div>
                </div>
                <div>
                    <paper-dropdown-menu label="{{resource.fields.title.title}}" id="adultPaxTitle" required auto-validate error-message="{{resource.fields.title.errors}}">
                        <paper-listbox slot="dropdown-content" selected="{{titleValue}}">
                            <template is="dom-repeat" items={{resource.fields.title.values}}>
                                <paper-item>{{item.key}}</paper-item>
                            </template>
                        </paper-listbox>
                    </paper-dropdown-menu>
                    <input is="iron-input" type="hidden" bind-value="[[titleValue]]">
                </div>

                <div>
                    <paper-input label="{{resource.fields.firstName.title}}" class="inputAdultCount" id="adultFirstName" required auto-validate error-message="{{resource.fields.firstName.errors}}"></paper-input>
                </div>
                <div>
                    <paper-input label="{{resource.fields.lastName.title}}" id="adultLastName" required auto-validate error-message="{{resource.fields.lastName.errors}}"></paper-input>
                </div>

            </div>
            <div id="inputForm2">
                <div id="adultEmailAndLabel">
                    <paper-input label="{{resource.fields.email.title}}" id="adultEmail" hidden$="{{showEmailAddress}}" required auto-validate
                        error-message="{{resource.fields.email.errors}}"></paper-input>
                    <div id="adultEmailLabel" hidden$="{{showEmailAddress}}">{{resource.fields.email.info}}</div>
                </div>
                <div hidden$="{{showContactNumber}}">
                    <paper-dropdown-menu label="{{resource.fields.countryCode.title}}" id="adultCountryCode" required auto-validate error-message="{{resource.fields.countryCode.errors}}">
                        <paper-listbox slot="dropdown-content" selected="{{countryCodeValue}}">
                            <template is="dom-repeat" items={{resource.fields.countryCode.values}}>
                                <paper-item value="{{item.value}}">{{item.key}}</paper-item>
                            </template>
                        </paper-listbox>
                    </paper-dropdown-menu>
                    <input is="iron-input" type="hidden" bind-value="[[countryCodeValue]]">
                </div>
                <div>
                    <paper-input label="{{resource.fields.contactNumber.title}}" id="adultContactNo" hidden$="{{showContactNumber}}" required
                        auto-validate error-message="{{resource.fields.contactNumber.errors}}"></paper-input>
                </div>
            </div>
        </form>
    </template>

    <script>
        /**
         * `pax-info`
         * 
         *
         * @customElement
         * @polymer
         * @demo demo/index.html
         */
        class PaxInfo extends Polymer.Element {
            static get is() {
                return 'pax-info';
            }
            static get properties() {
                return {
                    adultPaxCount: {
                        type: Number,
                    },
                    type: {
                        type: String,
                        value: 'Adult 1'
                    },
                    option: {
                        type: Object,
                        value: {
                            "requiredField": [],
                            "requiredFieldForLeadPax": []
                        }
                    },

                    paxList: {
                        type: Object,
                        value: {
                            "membership": {}
                        }
                    },
                    product: {
                        type: Object,
                        value: {
                            "rooms": []
                        }
                    },
                    countryCodeValue: {
                        type: String,
                        value: '0'
                    },
                    titleValue: {
                        type: String,
                        value: '0'
                    },
                    adultTitle: {
                        type: String,
                        value: ''
                    },
                    showTitle: {
                        type: Boolean,
                        value: true
                    },
                    showContactNumber: {
                        type: Boolean,
                        value: true
                    },
                    showEmailAddress: {
                        type: Boolean,
                        value: true
                    },
                    showTypeLabel: {
                        type: Boolean,
                        value: false
                    },
                }
            }
            isValidPaxInfo() {
                var adultFirstNameValidation = this.$.adultFirstName;
                var adultLastNameValiadtion = this.$.adultLastName;
                var adultTitleValidation = this.$.adultPaxTitle;
                var adultEmailValidation = this.$.adultEmail;
                var adultCountryCodeValidation = this.$.adultCountryCode;
                var adultContactNumberValidation = this.$.adultContactNo;
                if (adultFirstNameValidation.value === undefined) {
                    adultFirstNameValidation.invalid = true;
                }
                if (adultLastNameValiadtion.value === undefined) {
                    adultLastNameValiadtion.invalid = true;
                }
                if (adultEmailValidation.value === undefined) {
                    adultEmailValidation.invalid = true;
                }
                if (adultContactNumberValidation.value === undefined) {
                    adultContactNumberValidation.invalid = true;
                }
                if (this.index === 1) {
                    if (adultFirstNameValidation.invalid || adultLastNameValiadtion.invalid ||                        
                        adultContactNumberValidation.invalid || adultEmailValidation.invalid) {
                        return true;
                    }
                }
                else {
                    if (adultFirstNameValidation.invalid || adultLastNameValiadtion.invalid )
                    {
                        return true;
                    }
                }
            }
            _typeLabelIfAdultIsOnlyOne() {
                var adultCount = this.adultPaxCount;
                if (adultCount === 1) {
                    this.showTypeLabel = true;
                }
            }

            _showAllowFieldsForLeadPax() {
                if (this.index === 1) {
                    var checkLeadPax = this.option.allowContactNumberForLeadPax;
                    if (checkLeadPax === true) {
                        this.showContactNumber = false;
                    }
                    var checkLeadPax = this.option.allowEmailForLeadPax;
                    if (checkLeadPax === true) {
                        this.showEmailAddress = false;
                    }
                }

            }
            _showAllowFields() {
                var check = this.option.allowContactNumber;
                if (check === true && this.index != 1) {
                    this.showContactNumber = false;
                }
                var check = this.option.allowEmail;
                if (check === true && this.index != 1) {
                    this.showEmailAddress = false;
                }
            }
            ready() {
                super.ready();
                this._showAllowFieldsForLeadPax();
                this._showAllowFields();
                this._typeLabelIfAdultIsOnlyOne();
                // this.isValidAdultPax();
                var a = this.$.adultFirstName;
            }

        }

        window.customElements.define(PaxInfo.is, PaxInfo);
    </script>
</dom-module>